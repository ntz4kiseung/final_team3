<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="com.test.mybatis.ISignupDAO">
 
 	<select id="checkId" resultType="java.lang.Integer">
 		SELECT COUNT(USERID) AS COUNT
		FROM LOGIN
		WHERE UPPER(USERID) = UPPER(#{userid })
 	</select>
 	
 	<select id="checkNick" resultType="java.lang.Integer">
 		SELECT COUNT(NICKNAME) AS COUNT
		FROM USER_ESSENTIAL
		WHERE UPPER(NICKNAME) = UPPER(#{nickname })
 	</select>
 	
 	<select id="addrSiList" resultType="com.test.mybatis.AddrDTO">
 		SELECT ADDRSIID AS ADDRSIID1, ADDRSINAME  AS ADDRSINAME1
		FROM ADDR_SI
 	</select>
 	
 	<select id="addrGuList" resultType="com.test.mybatis.AddrDTO">
		SELECT ADDRGUID AS ADDRGUID1, ADDRGUNAME AS ADDRGUNAME1
		FROM ADDR_GU
        where ADDRSIID=#{siid }
 	</select>
 	
 	<!-- 대분류 출력 쿼리문 -->
 	<select id="interMainList" resultType="com.test.mybatis.InterDTO">
 		SELECT INTERMAINID AS INTERMAINID1, INTERMAINNAME AS INTERMAINNAME1
		FROM INTEREST_MAIN
 	</select>
 	
 	<select id="interSubList" resultType="com.test.mybatis.InterDTO">
 		SELECT INTERSUBID AS INTERSUBID1, INTERSUBNAME AS INTERSUBNAME1
		FROM INTEREST_SUB
        WHERE INTERMAINID = #{mainid}
 	</select>
 	
 	<insert id = "userLoginInsert">
 	INSERT INTO LOGIN(USERID, PWD, ROLEID)
	VALUES(#{userId }, CRYPTPACK.ENCRYPT(#{pwd }, 'JAVA006$'), 'RL00002')
 	</insert>
 	
 	<insert id = "userEssentialInsert">
 	INSERT INTO USER_ESSENTIAL(USERID, NICKNAME, NAME, BIRTH, GENDERID, TEL, EMAIL, REGISTERDATE, BADGELOGID)
	VALUES(#{user.userId }, #{user.nickname }, #{user.name } , TO_DATE(#{user.birth },'YYMMDD'), #{user.genderId }, #{user.tel }, #{user.email }, SYSDATE, #{badgelogid})
 	</insert>
 	
 	<insert id = "userSubInsert">
 	INSERT INTO USER_SUB(ID, USERID, SNS, INTRODUCE)
	VALUES(USER_SUB_SEQ.NEXTVAL, #{userId }, #{sns }, #{introduce })
 	</insert>
 	
 	<insert id = "userAddrInsert1">
 	INSERT INTO USER_ADDR(ID, USERID, ADDRGUID)
	VALUES(USER_ADDR_SEQ.NEXTVAL, #{userId }, #{addrGuId1 })
 	</insert>
 	
 	<insert id = "userAddrInsert2">
 	INSERT INTO USER_ADDR(ID, USERID, ADDRGUID)
	VALUES(USER_ADDR_SEQ.NEXTVAL, #{userId }, #{addrGuId2 })
 	</insert>
 	
 	<insert id = "userAddrInsert3">
 	INSERT INTO USER_ADDR(ID, USERID, ADDRGUID)
	VALUES(USER_ADDR_SEQ.NEXTVAL, #{userId }, #{addrGuId3 })
 	</insert>
 	
 	<insert id = "userInterInsert1">
 	INSERT INTO USER_INTEREST(ID, USERID, INTERSUBID)
	VALUES (USER_INTEREST_SEQ.NEXTVAL, #{userId }, #{interSubId1 })
 	</insert>
 	
 	<insert id = "userInterInsert2">
 	INSERT INTO USER_INTEREST(ID, USERID, INTERSUBID)
	VALUES (USER_INTEREST_SEQ.NEXTVAL, #{userId }, #{interSubId2 })
 	</insert>
 	
 	<insert id = "userInterInsert3">
 	INSERT INTO USER_INTEREST(ID, USERID, INTERSUBID)
	VALUES (USER_INTEREST_SEQ.NEXTVAL, #{userId }, #{interSubId3 })
 	</insert>
 	
 	
 	
 	<insert id = "userTelInsert">
	INSERT INTO USER_CERTIFICATION(ID, USERID, CODE, CERTIDATE, CERTIID)
	VALUES(USER_CERTIFICATION_SEQ.NEXTVAL, #{userId },  #{telCheck}, SYSDATE, 'CT00001')
 	</insert>
 	
 	<insert id = "userEmailInsert"> 	
 	INSERT INTO USER_CERTIFICATION(ID, USERID, CODE, CERTIDATE, CERTIID)
	VALUES(USER_CERTIFICATION_SEQ.NEXTVAL, #{userId },  #{emailCheck}, SYSDATE, 'CT00002')
 	</insert>
 	
 	<!-- 뉴비 뱃지 주기 -->
 	
 	<insert id = "userNewBadgeInsert">
 	INSERT INTO USER_BADGE_LOG(BADGELOGID, USERID, BADGEPOINTID) 
 	VALUES(ADD_ID('USER_BADGE_LOG', 'BADGELOGID', 'BL'), #{userId}, 'BP00011')
 	</insert>
 	
 	<select id = "userNewBadgeSelect" resultType = "java.lang.String">
 	SELECT BADGELOGID
	FROM USER_BADGE_LOG
	WHERE USERID = #{userId}
 	</select>
 	
 	
 	
 	
 	
  
 </mapper>