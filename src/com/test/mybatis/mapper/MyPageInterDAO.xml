<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.test.mybatis.IInterDAO">
	
	<select id="inter" resultType="com.test.mybatis.InterDTO">
		SELECT USERID, ID, INTERMAINNAME1, INTERSUBNAME1, INTERMAINNAME2, INTERSUBNAME2, INTERMAINNAME3, INTERSUBNAME3
		FROM
		(
		    SELECT USERID ,ID ,INTERSUBNAME AS INTERSUBNAME1 , INTERMAINNAME AS INTERMAINNAME1
		                ,LEAD(INTERSUBNAME,1) OVER (ORDER BY ID) AS INTERSUBNAME2,LEAD(INTERMAINNAME,1) OVER (ORDER BY ID) AS INTERMAINNAME2
		                , LEAD(INTERSUBNAME,2) OVER (ORDER BY ID) AS INTERSUBNAME3,LEAD(INTERMAINNAME,2) OVER (ORDER BY ID) AS INTERMAINNAME3
		    FROM USERINTER_VIEW
		    WHERE USERID='B001'
		)
		WHERE ID=(SELECT MIN(ID) FROM USERINTER_VIEW WHERE USERID='B001')
	</select>
	
</mapper>
