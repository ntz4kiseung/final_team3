<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.test.mybatis.IAddrDAO">
	
	<select id="addr" resultType="com.test.mybatis.AddrDTO">
		SELECT USERID, ID, ADDRSINAME1, ADDRGUNAME1, ADDRSINAME2, ADDRGUNAME2, ADDRSINAME3, ADDRGUNAME3
		FROM
		(
		    SELECT USERID ,ID ,ADDRSINAME AS ADDRSINAME1 , ADDRGUNAME AS ADDRGUNAME1
		                ,LEAD(ADDRSINAME,1) OVER (ORDER BY ID) AS ADDRSINAME2,LEAD(ADDRGUNAME,1) OVER (ORDER BY ID) AS ADDRGUNAME2
		                , LEAD(ADDRSINAME,2) OVER (ORDER BY ID) AS ADDRSINAME3,LEAD(ADDRGUNAME,2) OVER (ORDER BY ID) AS ADDRGUNAME3
		    FROM USERADDR_VIEW
		    WHERE USERID='B001'
		)
		WHERE ID=(SELECT MIN(ID) FROM USERADDR_VIEW WHERE USERID='B001')
	</select>
	
</mapper>
