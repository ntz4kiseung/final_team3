<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.test.mybatis.IReviewDAO">
	<insert id="reviewInsertMain">
		INSERT INTO REVIEW(REVIEWID, POSTID, GIVEUSERID, TAKEUSERID, GRADE, REVIEWDATE)
		VALUES(ADD_ID('REVIEW','REVIEWID', 'RV'), #{postId}, #{giveUserId}, #{takeUserId}, #{grade}, SYSDATE)
	</insert>

	<insert id="reviewInsertSub" statementType="CALLABLE">
		{call INSERT_REVIEW_SUB(#{reviewId, jdbcType=VARCHAR}, #{badgePointId, jdbcType=VARCHAR}, #{contents, jdbcType=VARCHAR})}
	</insert>
	
	<select id="getNextReviewId" resultType="java.lang.String">
		SELECT ADD_ID('REVIEW','REVIEWID', 'RV')
		FROM DUAL
	</select>
	
	<select id="inquryView" resultType="com.test.mybatis.ReviewDTO">
		SELECT POSTID ,USERID, GIVEUSERID, GIVEUSERNAME, GIVEUSERURL, GRADE, TAKEURL, CONTENTS
		FROM VIEW_REVIEW_INQURY
		WHERE UPPER(USERID) = UPPER(#{userId}) AND POSTID = #{postId}
	</select>
</mapper>


